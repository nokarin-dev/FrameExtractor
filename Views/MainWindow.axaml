<Window xmlns="https://github.com/avaloniaui"
        xmlns:vm="using:FrameExtractor.ViewModels"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="840" d:DesignHeight="460"
        x:Class="FrameExtractor.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="FrameExtractor"
        Width="840"
        Height="460"
        TransparencyLevelHint="AcrylicBlur, Blur, Transparent"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        WindowStartupLocation="CenterScreen"
        CanResize="False">
    
    <Window.Resources>
        <CornerRadius x:Key="WindowCornerRadius">12</CornerRadius>
    </Window.Resources>
    
    <!-- Main Content with Rounded Corners -->
    <Border CornerRadius="{StaticResource WindowCornerRadius}" ClipToBounds="True">
        <Grid RowDefinitions="Auto,*">
            
            <!-- Custom Title Bar -->
            <Grid Grid.Row="0" Height="40" Background="Transparent" IsHitTestVisible="True">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Title and Drag Area -->
                <TextBlock Grid.Column="0" 
                           Text="Frame Extractor" 
                           VerticalAlignment="Center" 
                           Margin="16,0,0,0"
                           FontWeight="SemiBold"
                           Foreground="White"
                           IsHitTestVisible="False"/>
                
                <!-- Close Button -->
                <Button Grid.Column="1" 
                        Width="30" Height="30" 
                        Margin="0,5,10,5"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Content="âœ–"
                        FontSize="12"
                        Command="{Binding CloseCommand}"/>
            </Grid>

            <!-- Main Content -->
            <ScrollViewer Grid.Row="1" Padding="20,0,20,20">
                <StackPanel Spacing="15">
                    <!-- Video Input Section -->
                    <Border>
                        <StackPanel Spacing="10">
                            <TextBlock Text="Input Video"/>
                            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                                <TextBox Grid.Column="0" 
                                         Text="{Binding VideoPath}"
                                         Watermark="Select video file..."
                                         IsReadOnly="False"/>
                                <Button Grid.Column="1" 
                                        Content="Browse"
                                        HorizontalContentAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        Width="100"
                                        Command="{Binding BrowseVideoCommand}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Output Directory Section -->
                    <Border>
                        <StackPanel Spacing="10">
                            <TextBlock Text="Output Directory"/>
                            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                                <TextBox Grid.Column="0" 
                                         Text="{Binding OutputDirectory}"
                                         Watermark="Select output directory..."
                                         IsReadOnly="False"/>
                                <Button Grid.Column="1" 
                                        Content="Browse"
                                        HorizontalContentAlignment="Center"
                                        VerticalContentAlignment="Center"
                                        Width="100"
                                        Command="{Binding BrowseOutputCommand}"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Time Range Section -->
                    <Border>
                        <StackPanel Spacing="10">
                            <TextBlock Text="Time Range"/>
                            <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="Start Time"/>
                                    <TextBox Text="{Binding StartTime}"
                                             Watermark="HH:MM:SS"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="End Time"/>
                                    <TextBox Text="{Binding EndTime}"
                                             Watermark="HH:MM:SS"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Extraction Settings Section -->
                    <Border>
                        <StackPanel Spacing="10">
                            <TextBlock Text="Extraction Settings"/>
                            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="10">
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="FPS"/>
                                    <TextBox Text="{Binding Fps}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="Frame Name"/>
                                    <TextBox Text="{Binding FrameName}"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="Format"/>
                                    <ComboBox SelectedItem="{Binding SelectedFormat}"
                                              ItemsSource="{Binding Formats}"
                                              HorizontalAlignment="Stretch"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Extract Button -->
                    <Button Content="Extract Frames"
                            HorizontalAlignment="Center"
                            HorizontalContentAlignment="Center"
                            VerticalContentAlignment="Center"
                            Height="40"
                            Width="300"
                            Margin="0,10,0,0"
                            CornerRadius="10"
                            Command="{Binding ExtractFramesCommand}"
                            IsEnabled="{Binding CanExtract}"/>

                    <!-- Progress Section -->
                    <Border IsVisible="{Binding IsExtracting}">
                        <StackPanel Spacing="10">
                            <TextBlock Text="{Binding ProgressText}" 
                                       HorizontalAlignment="Center"
                                       Foreground="White"/>
                            <ProgressBar IsIndeterminate="True"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Border>
</Window>
